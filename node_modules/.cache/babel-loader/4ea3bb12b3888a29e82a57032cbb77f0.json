{"ast":null,"code":"import _slicedToArray from\"/home/iryna/Desktop/NodeJS-in-AWS-Training/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{makeStyles}from'@material-ui/core/styles';import Stepper from'@material-ui/core/Stepper';import Step from'@material-ui/core/Step';import StepLabel from'@material-ui/core/StepLabel';import Button from'@material-ui/core/Button';import Typography from'@material-ui/core/Typography';import ReviewCart from'components/pages/PageCart/components/ReviewCart';import ReviewOrder from'components/pages/PageCart/components/ReviewOrder';import{useDispatch,useSelector}from\"react-redux\";import{selectCartItems,clearCart}from\"store/cartSlice\";import PaperLayout from\"components/PaperLayout/PaperLayout\";import{Formik,Form,FastField}from\"formik\";import Grid from\"@material-ui/core/Grid\";import{TextField}from'formik-material-ui';import axios from\"axios\";import API_PATHS from\"constants/apiPaths\";import{AddressSchema,OrderSchema}from\"models/Order\";var useStyles=makeStyles(function(theme){return{stepper:{padding:theme.spacing(3,0,5)},buttons:{display:'flex',justifyContent:'flex-end'},button:{marginTop:theme.spacing(3),marginLeft:theme.spacing(1)}};});var steps=['Review your cart','Shipping address','Review your order'];var initialAddressValues=AddressSchema.cast();var CartIsEmpty=function CartIsEmpty(){return/*#__PURE__*/React.createElement(Typography,{variant:\"h6\",gutterBottom:true},\"The cart is empty. Didn't you like anything in our shop?\");};var Success=function Success(){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Typography,{variant:\"h5\",gutterBottom:true},\"Thank you for your order.\"),/*#__PURE__*/React.createElement(Typography,{variant:\"subtitle1\"},\"Your order is placed. Our manager will call you soon to clarify the details.\"));};var renderForm=function renderForm(){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Typography,{variant:\"h6\",gutterBottom:true},\"Shipping address\"),/*#__PURE__*/React.createElement(Grid,{container:true,spacing:2},/*#__PURE__*/React.createElement(Grid,{item:true,xs:12,sm:6},/*#__PURE__*/React.createElement(FastField,{component:TextField,name:\"lastName\",label:\"Last Name\",fullWidth:true,autoComplete:\"off\",required:true})),/*#__PURE__*/React.createElement(Grid,{item:true,xs:12,sm:6},/*#__PURE__*/React.createElement(FastField,{component:TextField,name:\"firstName\",label:\"First Name\",fullWidth:true,autoComplete:\"off\",required:true})),/*#__PURE__*/React.createElement(Grid,{item:true,xs:12},/*#__PURE__*/React.createElement(FastField,{component:TextField,name:\"address\",label:\"Shipping address\",fullWidth:true,autoComplete:\"off\",multiline:true})),/*#__PURE__*/React.createElement(Grid,{item:true,xs:12},/*#__PURE__*/React.createElement(FastField,{component:TextField,name:\"comment\",label:\"Comment\",fullWidth:true,autoComplete:\"off\",multiline:true}))));};export default function PageCart(){var classes=useStyles();var _React$useState=React.useState(0),_React$useState2=_slicedToArray(_React$useState,2),activeStep=_React$useState2[0],setActiveStep=_React$useState2[1];var cartItems=useSelector(selectCartItems);var isCartEmpty=!cartItems.length;var _useState=useState(initialAddressValues),_useState2=_slicedToArray(_useState,2),address=_useState2[0],setAddress=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isFormValid=_useState4[0],setIsFormValid=_useState4[1];var dispatch=useDispatch();var handleNext=function handleNext(){setActiveStep(activeStep+1);if(activeStep===2){var formattedValues=OrderSchema.cast({items:cartItems.map(function(i){return{productId:i.product.id,count:i.count};}),address:address});axios.put(\"\".concat(API_PATHS.order,\"/order\"),formattedValues).then(function(){dispatch(clearCart());setActiveStep(activeStep+1);});}};var handleBack=function handleBack(){setActiveStep(activeStep-1);};return/*#__PURE__*/React.createElement(PaperLayout,null,/*#__PURE__*/React.createElement(Typography,{component:\"h1\",variant:\"h4\",align:\"center\"},\"Checkout\"),/*#__PURE__*/React.createElement(Stepper,{activeStep:activeStep,className:classes.stepper},steps.map(function(label){return/*#__PURE__*/React.createElement(Step,{key:label},/*#__PURE__*/React.createElement(StepLabel,null,label));})),/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Formik,{enableReinitialize:false,initialValues:initialAddressValues,validationSchema:AddressSchema,isInitialValid:false,onSubmit:function onSubmit(){return undefined;}},function(props){var values=props.values,isValid=props.isValid;setAddress(values);setIsFormValid(isValid);return/*#__PURE__*/React.createElement(Form,null,isCartEmpty&&activeStep===0&&/*#__PURE__*/React.createElement(CartIsEmpty,null),activeStep===0&&!isCartEmpty&&/*#__PURE__*/React.createElement(ReviewCart,null),activeStep===1&&renderForm(),activeStep===2&&/*#__PURE__*/React.createElement(ReviewOrder,{address:address,items:cartItems}),activeStep===3&&/*#__PURE__*/React.createElement(Success,null));}),activeStep<=2&&/*#__PURE__*/React.createElement(\"div\",{className:classes.buttons},activeStep!==0&&/*#__PURE__*/React.createElement(Button,{onClick:handleBack,className:classes.button},\"Back\"),!isCartEmpty&&/*#__PURE__*/React.createElement(Button,{variant:\"contained\",color:\"primary\",onClick:handleNext,className:classes.button,disabled:activeStep===1&&!isFormValid},activeStep===steps.length-1?'Place order':'Next'))));}","map":{"version":3,"sources":["/home/iryna/Desktop/NodeJS-in-AWS-Training/src/components/pages/PageCart/PageCart.tsx"],"names":["React","useState","makeStyles","Stepper","Step","StepLabel","Button","Typography","ReviewCart","ReviewOrder","useDispatch","useSelector","selectCartItems","clearCart","PaperLayout","Formik","Form","FastField","Grid","TextField","axios","API_PATHS","AddressSchema","OrderSchema","useStyles","theme","stepper","padding","spacing","buttons","display","justifyContent","button","marginTop","marginLeft","steps","initialAddressValues","cast","CartIsEmpty","Success","renderForm","PageCart","classes","activeStep","setActiveStep","cartItems","isCartEmpty","length","address","setAddress","isFormValid","setIsFormValid","dispatch","handleNext","formattedValues","items","map","i","productId","product","id","count","put","order","then","handleBack","label","undefined","props","values","isValid"],"mappings":"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","sourcesContent":["import React, {useState} from 'react';\nimport {makeStyles} from '@material-ui/core/styles';\nimport Stepper from '@material-ui/core/Stepper';\nimport Step from '@material-ui/core/Step';\nimport StepLabel from '@material-ui/core/StepLabel';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\nimport ReviewCart from 'components/pages/PageCart/components/ReviewCart';\nimport ReviewOrder from 'components/pages/PageCart/components/ReviewOrder';\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {selectCartItems, clearCart} from \"store/cartSlice\";\nimport PaperLayout from \"components/PaperLayout/PaperLayout\";\nimport {Formik, Form, FormikProps, FormikValues, FastField} from \"formik\";\nimport Grid from \"@material-ui/core/Grid\";\nimport {TextField} from 'formik-material-ui';\nimport axios from \"axios\";\nimport API_PATHS from \"constants/apiPaths\";\nimport {AddressSchema, OrderSchema} from \"models/Order\";\n\nconst useStyles = makeStyles((theme) => ({\n  stepper: {\n    padding: theme.spacing(3, 0, 5),\n  },\n  buttons: {\n    display: 'flex',\n    justifyContent: 'flex-end',\n  },\n  button: {\n    marginTop: theme.spacing(3),\n    marginLeft: theme.spacing(1),\n  },\n}));\n\nconst steps = ['Review your cart', 'Shipping address', 'Review your order'];\n\nconst initialAddressValues: any = AddressSchema.cast();\n\nconst CartIsEmpty = () => (\n  <Typography variant=\"h6\" gutterBottom>\n    The cart is empty. Didn't you like anything in our shop?\n  </Typography>\n);\n\nconst Success = () => (\n  <React.Fragment>\n    <Typography variant=\"h5\" gutterBottom>\n      Thank you for your order.\n    </Typography>\n    <Typography variant=\"subtitle1\">\n      Your order is placed. Our manager will call you soon to clarify the details.\n    </Typography>\n  </React.Fragment>\n);\n\nconst renderForm = () => (\n  <>\n    <Typography variant=\"h6\" gutterBottom>\n      Shipping address\n    </Typography>\n    <Grid container spacing={2}>\n      <Grid item xs={12} sm={6}>\n        <FastField\n          component={TextField}\n          name=\"lastName\"\n          label=\"Last Name\"\n          fullWidth\n          autoComplete=\"off\"\n          required\n        />\n      </Grid>\n      <Grid item xs={12} sm={6}>\n        <FastField\n          component={TextField}\n          name=\"firstName\"\n          label=\"First Name\"\n          fullWidth\n          autoComplete=\"off\"\n          required\n        />\n      </Grid>\n      <Grid item xs={12}>\n        <FastField\n          component={TextField}\n          name=\"address\"\n          label=\"Shipping address\"\n          fullWidth\n          autoComplete=\"off\"\n          multiline\n        />\n      </Grid>\n      <Grid item xs={12}>\n        <FastField\n          component={TextField}\n          name=\"comment\"\n          label=\"Comment\"\n          fullWidth\n          autoComplete=\"off\"\n          multiline\n        />\n      </Grid>\n    </Grid>\n  </>\n);\n\nexport default function PageCart() {\n  const classes = useStyles();\n  const [activeStep, setActiveStep] = React.useState<number>(0);\n  const cartItems = useSelector(selectCartItems);\n  const isCartEmpty = !cartItems.length;\n  const [address, setAddress] = useState<FormikValues>(initialAddressValues);\n  const [isFormValid, setIsFormValid] = useState<boolean>(false);\n  const dispatch = useDispatch();\n\n  const handleNext = () => {\n    setActiveStep(activeStep + 1);\n    if (activeStep === 2) {\n      const formattedValues = OrderSchema.cast({\n        items: cartItems.map(i => ({productId: i.product.id, count: i.count})),\n        address\n      });\n      axios.put(`${API_PATHS.order}/order`, formattedValues)\n        .then(() => {\n          dispatch(clearCart());\n          setActiveStep(activeStep + 1);\n        });\n    }\n  };\n\n  const handleBack = () => {\n    setActiveStep(activeStep - 1);\n  };\n\n  return (\n    <PaperLayout>\n      <Typography component=\"h1\" variant=\"h4\" align=\"center\">\n        Checkout\n      </Typography>\n      <Stepper activeStep={activeStep} className={classes.stepper}>\n        {steps.map((label) => (\n          <Step key={label}>\n            <StepLabel>{label}</StepLabel>\n          </Step>\n        ))}\n      </Stepper>\n      <React.Fragment>\n        <Formik\n          enableReinitialize={false}\n          initialValues={initialAddressValues}\n          validationSchema={AddressSchema}\n          isInitialValid={false}\n          onSubmit={() => undefined}\n        >\n          {(props: FormikProps<FormikValues>) => {\n            const {values, isValid} = props;\n            setAddress(values);\n            setIsFormValid(isValid);\n            return (\n              <Form>\n                {isCartEmpty && activeStep === 0 && <CartIsEmpty/>}\n                {activeStep === 0 && !isCartEmpty && <ReviewCart/>}\n                {activeStep === 1 && renderForm()}\n                {activeStep === 2 && <ReviewOrder address={address} items={cartItems}/>}\n                {activeStep === 3 && <Success/>}\n              </Form>\n            )\n          }}\n        </Formik>\n\n        {activeStep <= 2 && <div className={classes.buttons}>\n          {activeStep !== 0 && (\n            <Button onClick={handleBack} className={classes.button}>\n              Back\n            </Button>\n          )}\n          {!isCartEmpty && (\n            <Button\n              variant=\"contained\"\n              color=\"primary\"\n              onClick={handleNext}\n              className={classes.button}\n              disabled={activeStep === 1 && !isFormValid}\n            >\n              {activeStep === steps.length - 1 ? 'Place order' : 'Next'}\n            </Button>)}\n        </div>}\n      </React.Fragment>\n    </PaperLayout>\n  );\n}"]},"metadata":{},"sourceType":"module"}